var j$=$.noConflict(),swiperOpts={grabCursor:!0,prevButton:".swiper-button-prev",nextButton:".swiper-button-next",slidesPerView:4,slidesPerGroup:4,spaceBetween:24,breakpoints:{480:{slidesPerView:1,slidesPerGroup:1},768:{slidesPerView:2,slidesPerGroup:2},1440:{slidesPerView:3,slidesPerGroup:3}}},templateSwpr='<li class="swiper-slide"><div class="card"><a class="card-link" href="#"><div class="card-media"></div><div class="item-info"><div class="item-name"><span class="bold">{{description}}</span></div><div class="item-sku"><span class="font_small uppercase">{{skuid}}</span></div><div class="item-price"><span class="bold">j${{price}} /EA</span></div></div></a></div></li>',templateGrid='<li class="prod-grid__item" data-brand="{{brand}}" data-price="{{price}}"><div class="card"><a class="card-link" href="#"><div class="card-media"></div><div class="item-info"><div class="item-name"><span class="bold">{{description}}</span></div><div class="item-sku"><span class="font_small uppercase">{{skuid}}</span></div><div class="item-price"><span class="bold">j${{price}} /EA</span></div></div></a></div></li>',cfg={swiper:swiperOpts,ajx:{url:"data/smartDeals_sample.json",prodCtg:["Save on Craves","Sweet Deals"]},domTrg:[".swiper-wrapper",".list-wrapper"],tmps:[templateSwpr,templateGrid]},dataOps=function(e,i,r,t){var s=e.slice(1,r),n=function(e){return s.filter(function(i){return i.category===e})},a=function(e){for(var i=[],r=0;r<("string"==typeof e?1:e.length);r++)i.push(n("string"==typeof e?e:e[r]));return i};return a(i)},renderSct=function(e,i){for(var r,t=[],s=0;s<e.length;s++)r=renderTmp(e[s],"string"==typeof i?i:i[s]),t.push(r);return t},renderTmp=function(e,i){var r,t=[];return e.forEach(function(e){rendering=Mustache.render(j$.isArray(i)?i[0]:i,e),r=addBgImg(rendering,e),t.push(r)}),t},addBgImg=function(e,i){var r=j$(e);return r.find(".card-media").css("background-image","url("+i.imgURL+")"),r},initTrg=[j$(cfg.domTrg[0]),j$(cfg.domTrg[1])],insertTmp=function(e,i){for(var r=0;r<("string"==typeof i?1:i.length);r++)e[r].forEach(function(e){e.appendTo("string"==typeof i?i:i[r])});return i},findGreatest=function(e){for(var i=j$(e[0]).height(),r=0;r<e.length;r++){var t=j$(e[r]).height();t>i&&(i=t)}return i},findGreatestPB=function(e){return parseInt(j$(e[0]).css("padding-bottom"))},setSlideHeight=function(e){setTimeout(function(){for(var i=j$(e),r=j$(i).find(".card"),t=32,s=j$(e).find(".card-media"),n=j$(e).find(".item-info"),a=findGreatestPB(s),d=findGreatest(n),o=+a+d+t,c=0;c<r.length;c++)j$(r[c]).height(o)},100)},registerEvents=function(){j$(".view-more").on("click",function(e){j$.get(cfg.ajx.url,function(e,i){for(var r=dataOps(e,cfg.ajx.prodCtg[1],45,cfg.domTrg[0]),t=renderSct(r,cfg.tmps[1]),s=[],n=0;n<t[0].length;n++)s.push(t[0][n][0]);j$(".list-wrapper").imagesLoaded({background:".card-media"},function(e){gridIso.append(s).isotope("appended",s)})},"json")}),j$(".filter-select").on("change",function(){var e=this.value;if("*"===e)gridIso.isotope({filter:e});else{var e=this.value.match(/\w+/)[0];gridIso.isotope({filter:function(){return j$(this).data().brand===e}})}}),j$(".sort-select").on("change",function(){var e=this.value;gridIso.isotope({sortBy:e})}),j$(window).resize(function(){var e=j$(".prod-grid__rule"),i=j$(".swiper-slide");setSlideHeight(i),e.css("opacity",0),offsetHr(j$(".prod-grid__item")),setTimeout(e.css("opacity",1),1e3)})},gridIso=null,mySwiper=null,init=function(e){var i=dataOps(e,cfg.ajx.prodCtg,45,cfg.domTrg),r=renderSct(i,cfg.tmps);insertTmp(r,initTrg);j$(".list-wrapper").imagesLoaded({background:".card-media"},function(e){gridIso=j$(".list-wrapper").isotope({itemSelector:".prod-grid__item",layoutMode:"fitRows",getSortData:{name:".item-name",price:".item-price > span parseFloat"}})}),mySwiper=new Swiper(".swiper-container",cfg.swiper),setSlideHeight(".swiper-slide")};j$(document).ready(function(){j$.get(cfg.ajx.url,function(e){init(e)},"json"),registerEvents()});